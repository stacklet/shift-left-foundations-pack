policies:
  - name: aws-elb-force-secure-tls-policy
    resource: terraform.aws_alb_listener
    description: |
      Load balancer listeners should use current security policies which
      require TLS 1.2+.
    metadata:
      severity: critical
      creator: Stacklet
    filters:
      - type: value
        key: ssl_policy
        op: in
        value:
          - 'ELBSecurityPolicy-2015-05'
          - 'ELBSecurityPolicy-2016-08'
          - 'ELBSecurityPolicy-FS-2018-06'
          - 'ELBSecurityPolicy-FS-1-1-2019-08'
          - 'ELBSecurityPolicy-TLS-1-0-2015-04'
          - 'ELBSecurityPolicy-TLS-1-1-2017-01'
          - 'ELBSecurityPolicy-TLS13-1-0-2021-06'
          - 'ELBSecurityPolicy-TLS13-1-1-2021-06'
          - 'ELBSecurityPolicy-TLS13-1-2-Ext1-2021-06'
          - 'ELBSecurityPolicy-TLS13-1-2-Ext2-2021-06'
